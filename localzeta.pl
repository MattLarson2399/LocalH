#!/usr/bin/perl
#Contributors: Matt Larson
#Last updated: 08/17/2019

#computes the topological local zeta function associated to a Newton polyhedron

use strict;
use warnings;
use application "polytope";
use PDL;
use Algorithm::Combinatorics "subsets";
use Math::Matrix;

script("subs.pl");

#usage: multiplicityArray(AoA)
#computes the multiplicity of an array of r integer vectors
#i.e. computes the index of the lattice generated by the vectors in the group of all lattice points 
#in the vector space spanned by the vectors
#does this by taking the gcd of the determinents of the rxr minors
sub multiplicityArray{
	my @vectors = @{shift @_};
	my $num = scalar(@vectors);
	my @minors = subsets([0..scalar(@{$vectors[0]})-1], $num);
	#constructs matrix 
	my @matrixAoa = ();
	for my $i(0..($num - 1)){
		my @row = ();
		for my $j (0..($num - 1)){
			push(@row, $vectors[$i]->[$j]);
		}
		push(@matrixAoa, \@row);
	}
	my $a = new Math::Matrix(@matrixAoa);
	my $gcd = new Integer abs($a->determinant);
	for my $sub(@minors){
		@matrixAoa = ();
		for my $i(0..($num - 1)){
			my @row = ();
			for my $j (0..($num - 1)){
				push(@row, $vectors[$i]->[$sub->[$j]]);
			}
			push(@matrixAoa, \@row);
		}
		$a = new Math::Matrix(@matrixAoa);
		my $toint = new Integer(abs($a->determinant));
		$gcd = gcd($gcd, $toint);
		if ($gcd == 1){
			last;
		}
	}
	return $gcd;
}


#usage:facetContribution(diagram, array of vertices)
#the array of vertices should form a facet

sub facetContribution{

}








